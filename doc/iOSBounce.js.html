<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: iOSBounce.js</title>
    
    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">
    
    <h1 class="page-title">Source: iOSBounce.js</h1>
    
    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * @fileoverview 解决ios滚动边界缺陷
 * @author richieli
 * @version 0.1.0
 */

/**
 * @description iOSBounce
 * @param {root} context
 * @param {factory} function
 * @return {function} fix
 */
;(function(root, factory) {
    root["iOSBounce"] = factory();
}(this, function() {

    /**
     * @description {DOMElement} 滚动元素dom节点
     * @field
     */
    var fixedEle;

    /**
     * @description {boolean} 标志是否阻塞滚动元素touchmove默认行为
     * @field
     */
    var isFrozen = false;

    /**
     * @description 标志滚动元素开始时是否可以滚动
     * @return {boolean} 是否可以滚动
     */
    function isScrollable() {
        return fixedEle.scrollHeight > fixedEle.offsetHeight;
    }

    /**
     * @description 限制滚动元素边缘
     */
    function edgeDetection() {
        var scrollTop = fixedEle.scrollTop,
            scrollHeight = fixedEle.scrollHeight,
            offsetHeight = fixedEle.offsetHeight;
        if(scrollTop &lt;= 0) {
            fixedEle.scrollTop = 1;
        }
        if(scrollTop >= scrollHeight - offsetHeight) {
            fixedEle.scrollTop = scrollHeight - offsetHeight - 1;
        }
    }

    /**
     * @description 禁止事件默认行为以及冒泡
     * @param {event} e
     */
    var touchFreeze = function(e) {
        e.stopPropagation();
        e.preventDefault();
    };

    /**
     * @description touchstart事件处理逻辑
     * @param {event} e
     */
    var touchStart = function(e) {
        if(isScrollable()) {
            edgeDetection();
        }
        else {
            if(!isFrozen) {
                this.addEventListener("touchmove", touchFreeze, false);
                isFrozen = true;
            }
        }
    };

    /**
     * @description 绑定事件
     * @param {array} otherIDs 需要固定的元素的id
     */
    function initFixedEvent(otherIDs) {
        if(!!otherIDs) {
            var len = otherIDs.length;
            for(var i=0; i&lt;len; i++) {
                document.getElementById(otherIDs[i]).addEventListener("touchmove", function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                }, false);
            }
        }
        fixedEle.addEventListener("touchstart", touchStart, false);
    }

    /**
     * @description 主方法
     * @param {string} id 滚动元素的id
     * @param {array} otherIDs 需要固定的元素的id
     * @throws {string} 滚动元素id不能为空，否则抛出异常
     */
    function fix(id, otherIDs) {
        if (!id) {
            throw new Error('"id" argument is required');
        }
        fixedEle = document.getElementById(id);
        initFixedEvent(otherIDs);
    }
    return {
        fix: fix
    };
}));
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Fri Feb 13 2015 11:27:14 GMT+0800 (CST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
